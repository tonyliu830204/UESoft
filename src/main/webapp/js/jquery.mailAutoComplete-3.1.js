(function(e){e.fn.mailAutoComplete=function(t){var n={boxClass:"mailListBox",listClass:"mailListDefault",focusClass:"mailListFocus",markCalss:"mailListHlignt",zIndex:1,autoClass:!0,mailArr:["qq.com","126.com","163.com","hotmail.com","yahoo.com","yahoo.com.cn","live.com","sohu.com","sina.com","chinavalue.net","chinaksp.net"],textHint:!1,hintText:"",focusColor:"#333",blurColor:"#999"},r=e.extend({},n,t||{});r.autoClass&&e("#mailListAppendCss").size()===0&&e('<style id="mailListAppendCss" type="text/css">.mailListBox{border:1px solid #369; background:#fff; font:12px/20px Arial;}.mailListDefault{padding:0 5px;cursor:pointer;white-space:nowrap;}.mailListFocus{padding:0 5px;cursor:pointer;white-space:nowrap;background:#369;color:white;}.mailListHlignt{color:red;}.mailListFocus .mailListHlignt{color:#fff;}</style>').appendTo(e("head"));var i=r.boxClass,s=r.listClass,o=r.focusClass,u=r.markCalss,a=r.zIndex,f=mailArr=r.mailArr,l=r.textHint,c=r.hintText,h=r.focusColor,p=r.blurColor;e.createHtml=function(t,n,r){var i="";return e.isArray(n)&&e.each(n,function(e,a){e===r?i+='<div class="mailHover '+o+'" id="mailList_'+e+'"><span class="'+u+'">'+t+"</span>@"+n[e]+"</div>":i+='<div class="mailHover '+s+'" id="mailList_'+e+'"><span class="'+u+'">'+t+"</span>@"+n[e]+"</div>"}),i};var d=-1,m;e(this).each(function(){var t=e(this),n=e(".justForJs").size();if(n>0)return;var r=t.outerWidth(),s=t.outerHeight();t.wrap('<span style="display:inline-block;position:relative;"></span>').before('<div id="mailListBox_'+n+'" class="justForJs '+i+'" style="min-width:'+r+"px;_width:"+r+"px;position:absolute;left:-6000px;top:"+s+"px;z-index:"+a+';"></div>');var o=e("#mailListBox_"+n);t.focus(function(){e(this).css("color",h).parent().css("z-index",a);if(l&&c){var n=e.trim(e(this).val());n===c&&e(this).val("")}e(this).keyup(function(t){m=v=e.trim(e(this).val()),/@/.test(v)&&(m=v.replace(/@.*/,""));if(v.length>0){if(t.keyCode===38)d<=0&&(d=f.length),d--;else if(t.keyCode===40)d>=f.length-1&&(d=-1),d++;else if(t.keyCode===13)d>-1&&d<f.length&&e(this).val(e("#mailList_"+d).text());else if(/@/.test(v)){d=-1;var n=v.replace(/.*@/,"");f=e.map(mailArr,function(e){var t=new RegExp("@"+n);if(t.test("@"+e))return e})}else f=mailArr;o.html(e.createHtml(m,f,d)).css("left",0),t.keyCode===13&&d>-1&&d<f.length&&o.css("left","-6000px")}else o.css("left","-6000px");f.length==0&&o.css("left","-6000px")}).blur(function(){if(l&&c){var t=e.trim(e(this).val());t===""&&e(this).val(c)}e(this).css("color",p).unbind("keyup").parent().css("z-index",0),o.css("left","-6000px")});var r;e(".mailHover").live("mouseover",function(){d=Number(e(this).attr("id").split("_")[1]),o.html(e.createHtml(m,f,d)),r=e("#mailList_"+d).text()}),o.bind("mousedown",function(){t.val(r)})})})}})(jQuery)