function getLodop(e,t){var n="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='"+projectPath+"Lodop/install_lodop32.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",r="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='"+projectPath+"Lodop/install_lodop32.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",i="<br><font color='#FF00FF'>打印控件未安装!点击这里<a href='"+projectPath+"Lodop/install_lodop64.exe' target='_self'>执行安装</a>,安装后请刷新页面或重新进入。</font>",s="<br><font color='#FF00FF'>打印控件需要升级!点击这里<a href='"+projectPath+"Lodop/install_lodop64.exe' target='_self'>执行升级</a>,升级后请重新进入。</font>",o="<br><br><font color='#FF00FF'>注意：<br>1：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它。</font>",u=t;try{return navigator.appVersion.indexOf("MSIE")>=0&&(u=e),u==null||typeof u.VERSION=="undefined"?(navigator.userAgent.indexOf("Firefox")>=0&&(document.documentElement.innerHTML=o+document.documentElement.innerHTML),navigator.userAgent.indexOf("Win64")>=0?navigator.appVersion.indexOf("MSIE")>=0?document.write(i):document.documentElement.innerHTML=i+document.documentElement.innerHTML:navigator.appVersion.indexOf("MSIE")>=0?document.write(n):document.documentElement.innerHTML=n+document.documentElement.innerHTML,u):u.VERSION<"6.1.4.5"?(navigator.userAgent.indexOf("Win64")>=0?navigator.appVersion.indexOf("MSIE")>=0?document.write(s):document.documentElement.innerHTML=s+document.documentElement.innerHTML:navigator.appVersion.indexOf("MSIE")>=0?document.write(r):document.documentElement.innerHTML=r+document.documentElement.innerHTML,u):u}catch(a){return navigator.userAgent.indexOf("Win64")>=0?document.documentElement.innerHTML="Error:"+i+document.documentElement.innerHTML:document.documentElement.innerHTML="Error:"+n+document.documentElement.innerHTML,u}}function CreateOneFormPage(e){try{LODOP=getLodop(document.getElementById("LODOP_OB"),document.getElementById("LODOP_EM")),LODOP.SET_PRINT_STYLE("FontSize",18),LODOP.SET_PRINT_STYLE("Bold",1),LODOP.ADD_PRINT_HTM(88,200,350,600,$("#"+e).html())}catch(t){alert("创建失败！")}}function printPreview(e){try{CreateOneFormPage(e),LODOP.PREVIEW()}catch(t){alert("打印失败！")}}function printBriefly(e){try{CreateOneFormPage(e),LODOP.PRINT()}catch(t){alert("打印失败！")}}function printDirect(e){try{CreateOneFormPage(e),LODOP.PRINTA()}catch(t){alert("打印失败！")}}function printAllPagePreview(){try{LODOP=getLodop(document.getElementById("LODOP_OB"),document.getElementById("LODOP_EM")),LODOP.PRINT_INIT("打印控件功能演示_Lodop功能_全页"),LODOP.ADD_PRINT_HTM(0,0,"100%","100%",$("body").html()),LODOP.PREVIEW()}catch(e){alert("打印失败！")}}function exportExcelFile(e){try{LODOP=getLodop(document.getElementById("LODOP_OB"),document.getElementById("LODOP_EM")),LODOP.PRINT_INIT(""),LODOP.ADD_PRINT_TABLE(100,20,500,"100%",document.getElementById(e).innerHTML),LODOP.SET_SAVE_MODE("Orientation",2),LODOP.SET_SAVE_MODE("PaperSize",9),LODOP.SET_SAVE_MODE("Zoom",90),LODOP.SET_SAVE_MODE("CenterHorizontally",!0),LODOP.SET_SAVE_MODE("CenterVertically",!0),LODOP.SAVE_TO_FILE("新文件名.xls")}catch(t){alert("打印失败！请确认是否安装Microsoft Office")}}function printEsuyUIPreview(e,t){try{setPrintDiv(e,t),LODOP=getLodop(document.getElementById("LODOP_OB"),document.getElementById("LODOP_EM")),LODOP.PRINT_INIT("表单打印"),LODOP.SET_PRINT_STYLE("FontSize",18),LODOP.SET_PRINT_STYLE("Bold",1),LODOP.ADD_PRINT_HTM(0,0,"100%","100%",tableHtml),LODOP.PREVIEW()}catch(n){alert("打印失败！")}}function exportEsuyUIExcelFile(e,t,n){tableHtml="",setPrintDiv(e,t);var r=$("<form>");r.attr("style","display:none"),r.attr("target",""),r.attr("method","post"),r.attr("action",projectPath+"downLoadAction!downLoad.action");var i=$("<input>");i.attr("type","hidden"),i.attr("name","fileName"),i.attr("value",n+".xls"),r.append(i);var s=$("<textarea>");s.attr("type","hidden"),s.attr("name","html"),s.attr("value",tableHtml),r.append(s),$("body").append(r),excelFileDownLoad(r)}function excelFileDownLoad(e){e.submit()}function setPrintDiv(e,t){try{var n=null;t!=null&&t!=""&&(n=t.split(","));var r=new Map,i=new Array,s=$("#"+e+" div[class='datagrid-view1']"),o=s.find("table[class='datagrid-htable']"),u=o.find("tr");u.each(function(e){var t=$(this).find("td");t.each(function(e){var t=$(this).attr("field");if(t!=undefined){var i=$(this).attr("style");if(i==undefined)if(n!=null){if(in_array(n,t)){var s=$(this).find("span:first").html();r.put(t,s)}}else{var s=$(this).find("span:first").html();r.put(t,s)}}})});var a=$("#"+e+" div[class='datagrid-view2']"),f=a.find("table[class='datagrid-htable']"),l=f.find("tr");l.each(function(e){var t=$(this).find("td");t.each(function(e){var t=$(this).attr("field");if(t!=undefined){var i=$(this).attr("style");if(i==undefined)if(n!=null){if(in_array(n,t)){var s=$(this).find("span:first").html();r.put(t,s)}}else{var s=$(this).find("span:first").html();r.put(t,s)}}}),i.push(r)});var c=new Array,h=s.find("table[class='datagrid-btable']"),p=h.find("tr");p.each(function(e){var t=new Map,r=$(this).attr("class");if(r=="datagrid-row"||r=="datagrid-row datagrid-row-selected"){var i=$(this).find("td");i.length>0&&i.each(function(e){var r=$(this).attr("field");if(r!=undefined){var i=$(this).attr("style");if(i==undefined){var s;n!=null?in_array(n,r)&&(s=$(this).find("div:first").html(),t.put(r,s)):(s=$(this).find("div:first").html(),t.put(r,s))}}}),c.push(t)}else if(r=="treegrid-tr-tree"){var s=h.find("table[class='datagrid-btable']"),o=s.find("tr");o.each(function(e){var t=new Map,r=$(this).find("td");r.length>0&&r.each(function(e){var r=$(this).attr("field");if(r!=undefined){var i=$(this).attr("style");if(i==undefined){var s;n!=null?in_array(n,r)&&(s=$(this).find("div:first").html(),t.put(r,s)):(s=$(this).find("div:first").html(),t.put(r,s))}}}),c.push(t)})}});var d=new Array,v=a.find("table[class='datagrid-btable']"),m=v.find("tr");m.each(function(e){var t=new Map,r=$(this).attr("class");if(r=="datagrid-row"||r=="datagrid-row datagrid-row-selected"){var i=$(this).find("td");i.length>0&&i.each(function(e){var r=$(this).attr("field");if(r!=undefined){var i=$(this).attr("style");if(i==undefined){var s;n!=null?in_array(n,r)&&(s=$(this).find("div:first").html(),t.put(r,s)):(s=$(this).find("div:first").html(),t.put(r,s))}}}),d.push(t)}else if(r=="treegrid-tr-tree"){var s=h.find("table[class='datagrid-btable']"),o=s.find("tr");o.each(function(e){var t=new Map,r=$(this).find("td");r.length>0&&r.each(function(e){var r=$(this).attr("field");if(r!=undefined){var i=$(this).attr("style");if(i==undefined){var s;n!=null?in_array(n,r)&&(s=$(this).find("div:first").html(),t.put(r,s)):(s=$(this).find("div:first").html(),t.put(r,s))}}}),c.push(t)})}}),tableHtml='<p><div id=\'printDiv\' style="padding: 0px 0px 0px 0px;"><table style="border-collapse:collapse;border:solid 1px">';var g="";if(i.length>0){g="<thead><tr>";var y=i[0],b=y.values();for(var w=0;w<b.length;w++){var E=b[w],S=E.length*4;g+="<th><span sytle='"+S+"px'>"+E+"</span></th>"}g+="</tr></thead>"}var x="";x="<tbody>";if(d.length>0)for(var w=0;w<d.length;w++){x+="<tr>";var T=c[w];if(T!=null){var b=T.values();for(var N=0;N<b.length;N++)x+="<td>"+b[N]+"</td>"}var y=d[w],b=y.values();for(var N=0;N<b.length;N++)x+="<td>"+b[N]+"</td>";x+="</tr>"}x+="</tbody>",tableHtml+=g,tableHtml+=x,tableHtml+="</table></div></p>"}catch(C){alert("转换失败!")}}function in_array(e,t){var n=!1;for(var r=0;r<e.length;r++)e[r]==t&&(n=!0);return n}function getSelected(){var e=document.getElementById("right"),t="",n="";for(var r=e.options.length-1;r>=0;r--)e.options[r]&&(t!=""&&(t+=","),t+=e.options[r].value,n!=""&&(n+=","),n+=e.options[r].text);this.selectSubGroupFieldName=n,this.selectSubGroupField=t}function loadPage(e,t,n){$("#left").dblclick(function(){moveRight()}),$("#right").dblclick(function(){moveLeft()}),$("#add").click(function(){moveRight()}),$("#remove").click(function(){moveLeft()}),$("#addall").click(function(){$("#right").append($("#left option:selected"))}),$("#removeall").click(function(){$("#left").append($("#right option:selected"))}),$("#leftup").click(function(){up("left")}),$("#leftdown").click(function(){down("left")}),$("#rightup").click(function(){up("right")}),$("#rightdown").click(function(){down("right")}),t!=null?(loadPrintGroup(t),loadColumns(e,n)):loadColumns(e,n)}function loadPrintGroup(e){var t=projectPath+"printAction!getGroup.action",n=$("#groupDiv");$.ajax({type:"post",dataType:"json",url:t,data:{tableName:e},success:function(e){if(e){n.empty();var t=e.rows;for(var r=0;r<t.length;r++){var i=t[r],s='<input type="radio" value="'+i.groupId+'" id="'+i.groupId+'" name="'+i.tableName+'" onclick="check($(this))"/>',o="<span id="+i.groupId+">"+i.groupName+"</span>",u='<input id="'+i.tableName+"_"+i.groupId+'" type="hidden" value="'+i.groupSort+'"/><br/>';n.append(s).append(o).append(u),i.checked=="checked"&&($("#"+i.groupId).attr("checked","checked"),$("#groupName").val(i.groupName),$("#selectSubGroup").val(i.groupId),$("#selectSubGroupSort").val(i.groupSort),loadPrintNotes(i.groupId))}}},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}})}function loadColumns(e,t){var n=$("#left");n.empty();var r=$("#"+e),i=r.datagrid("options"),s=i.frozenColumns;if(s.length>0){var o=s[0];for(var u=0;u<o.length;u++){var a=o[u];if(t!=1){var f=a.hidden;f==undefined&&n.append("<option value='"+a.field+"'>"+a.title+"</option>")}else n.append("<option value='"+a.field+"'>"+a.title+"</option>")}}var l=i.columns;if(l.length>0){var c=l[0];for(var u=0;u<c.length;u++){var a=c[u];if(t!=1){var f=a.hidden;f==undefined&&n.append("<option value='"+a.field+"'>"+a.title+"</option>")}else n.append("<option value='"+a.field+"'>"+a.title+"</option>")}}}function loadPrintNotes(e){var t=$("#right"),n=projectPath+"printAction!getNotes.action";$.ajax({type:"post",dataType:"json",url:n,data:{groupId:e},success:function(e){t.empty();if(e){var n=e.rows;for(var r=0;r<n.length;r++){var i=n[r];t.append("<option value='"+i.fieldName+"'>"+i.fieldLable+"</option>"),$("#left").find("option").each(function(){$(this).val()==i.fieldName&&$(this).remove()})}}},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}})}function check(e){this.selectSubGroup=e.val(),this.selectSubGroupName=$("span[id='"+this.selectSubGroup+"']").html();var t=e.attr("name");this.selectSubGroupSort=$("#"+t+"_"+this.selectSubGroup).val(),$("#groupName").val(this.selectSubGroupName),$("#selectSubGroup").val(this.selectSubGroup),$("#selectSubGroupSort").val(this.selectSubGroupSort),loadColumns(this.dataGridId),loadPrintNotes(this.selectSubGroup)}function moveRight(){if(toEdit){var e=$("#left option"),t=$("#left option:selected");$("#right").append(t)}}function moveLeft(){if(toEdit){var e=$("#right option"),t=$("#right option:selected");$("#left").append(t)}}function up(e){if(toEdit){var t=$("#"+e+" option:selected");t.index()!=0&&t.each(function(){$(this).prev().before($(this))})}}function down(e){if(toEdit){var t=$("#"+e+" option"),n=$("#"+e+" option:selected"),r=n.length-1;if(n.index()!=t.length-1)for(i=r;i>=0;i--){var s=$(n.get(i));s.next().after(s)}}}function saveAndUpdateGroup(){this.selectSubGroupName=$("#groupName").val(),this.selectSubGroup=$("#selectSubGroup").val(),this.selectSubGroupSort=$("#selectSubGroupSort").val(),this.selectSubGroupName?(getSelected(),$.ajax({type:"post",dataType:"json",url:projectPath+"printAction!save.action",data:{groupId:this.selectSubGroup,groupName:this.selectSubGroupName,groupSort:this.selectSubGroupSort,tableName:this.type,fieldNames:this.selectSubGroupField,fieldLables:this.selectSubGroupFieldName},success:function(e){var t=e.success;alertMsg(e),t&&cancel_al()},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}})):alertMsg("您还没有选择一个分组信息或者新填写一个分组名称","warning")}function savaData(){this.dataGridId=$("#dataGridId").val(),loadColumns(this.dataGridId),setButton(),$("#groupName").val(""),$("#selectSubGroup").val(""),$("#selectSubGroupSort").val(""),$("#right").empty()}function updataData(){setButton()}function deleteData(){this.selectSubGroupName=$("#groupName").val(),this.selectSubGroup=$("#selectSubGroup").val(),$.messager.confirm("优亿软件提示","请确认是否将【"+this.selectSubGroupName+"】删除？",function(e){e&&$.ajax({type:"post",dataType:"json",url:projectPath+"printAction!delete.action",data:{groupId:this.selectSubGroup},success:function(e){alertMsg(e.msg)},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}})})}function setDefaultGroup(){setButton()}function setButton(){var e='<a id="save" href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-save" plain="true" onclick="saveAndUpdateGroup();">保存</a>',t='<a id="cancel" href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-undo" plain="true" onclick="cancel_al();">取消</a>';$("#button1").children("a").length==0&&($("#button1").append(e).append(t),$.parser.parse("#button1")),toEdit=!0,enableControl()}function cancel_al(){$("#button1").empty(),toEdit=!1,disableControl()}function enableControl(){$("#groupName").removeAttr("disabled"),$("#right").removeAttr("disabled"),$("#left").removeAttr("disabled")}function disableControl(){setTimeout("LockControl();",200)}function LockControl(){$("#groupName").attr("disabled","disabled"),$("#right").attr("disabled","disabled"),$("#left").attr("disabled","disabled")}function getSelectedField(e,t){var n=document.getElementById("right"),r="";for(var i=n.options.length-1;i>=0;i--)n.options[i]&&(r!=""&&(r+=","),r+=n.options[i].value);var s=$("#funType").val(),o=$("#dataGridId").val();s==1?ajaxFileUpload(o,e,r,t):s==2||s==0?(t!=null||t!=undefined)&&t(e,r):s==3&&hideDataGridColumn(o,e,r,t),customDialog.dialog("close")}function ajaxFileUpload(e,t,n,r){return jsProbar(),$.ajaxFileUpload({url:projectPath+"downLoadAction!analysisExcel.action?fieldNames="+n+"&fileFileName="+$("#filePath").val()+"&type="+t,secureuri:!1,fileElementId:"filePath",dataType:"json",beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(n,i){alert(n.msg),jsCloseProbar();if(n.success)if(r!=null||r!=undefined)r(t,n.obj);else{var s=$("#"+e);s.datagrid("loadData",{total:0,rows:[]});var o=$.parseJSON(n.obj);s.datagrid("loadData",o)}else alertMsg(n.msg,"info")},error:function(e,t,n){alert(e.msg),jsCloseProbar()}}),customDialog.dialog("close"),!1}function hideDataGridColumn(e,t,n,r){if(r!=null||r!=undefined)r(t,n);else{var i=$("#"+e),s=n.split(","),o=i.datagrid("options"),u=o.columns;if(u){var a=u[0];for(var f=0;f<a.length;f++){var l=a[f],c=l.field;s.in_array(c)&&i.datagrid("hideColumn",c)}}}}function coloropen(e,t){var n=$('<div style="overflow:hidden;"/>').dialog({href:projectPath+"common/base/print/printTemple.jsp",modal:!0,closable:!1,title:"套打模板",width:1e3,height:800,buttons:[{text:"打印",handler:function(){if(t!=null){var e=$("#templetKey").val(),r=$("input[name='"+e+"']:checked").val();t(r),n.dialog("close")}else alert("无回调函数")}},{text:"取消",handler:function(){n.dialog("close")}}],onLoad:function(){$.ajax({type:"post",dataType:"json",url:typeUri,data:{templetKey:e},success:function(t){$("#templetKey").val(e);var n=t.rows;for(var r=0;r<n.length;r++){var i=n[r],s='<input type="radio" value="'+i.templetId+'" id="'+i.templetId+'" name="'+e+'" style="width:10px;"onclick="checkTemple($(this))"/>',o="<span id='span"+i.templetId+"'>"+i.templetName+"</span><br/>";$("#printDivtitle").append(s).append(o),i.templetChecked=="checked"&&($("#"+i.templetId).attr("checked","checked"),$("#templetId").val(i.templetId))}},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}}),$("#addTempletBtn").click(function(){savaTempletData()}),$("#updateTempletBtn").click(function(){updataTempletData()}),$("#deleteTempletBtn").click(function(){deleteTempletData()}),disableTempletControl(),setTimeout("loadTemplet();",300)},onClose:function(){$(this).dialog("destroy")}})}function checkTemple(e){loadTemplet()}function savaTempletData(){setTempletButton(),$("#templetName").val(""),$("#printDivbody").val(""),templettype=$("#templetKey").val(),templetid=null}function updataTempletData(){setTempletButton(),templettype=$("#templetKey").val(),templetid=$("input[name='"+templettype+"']:checked").val()}function deleteTempletData(){var e=$("#templetKey").val(),t=$("input[name='"+e+"']:checked").val();$.ajax({type:"post",dataType:"json",url:deleteUri,data:{templetId:t,templetKey:e},success:function(e){alertMsg(e),reload(),cancelTempletButton(),reload()},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}})}function setTempletButton(){var e='<a id="save" href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-save" plain="true" onclick="saveAndUpdateTemplet();">保存</a>',t='<a id="cancel" href="javascript:void(0);" class="easyui-linkbutton" iconCls="icon-undo" plain="true" onclick="cancelTempletButton();">取消</a>';$("#button2").children("a").length==0&&($("#button2").append(e).append(t),$.parser.parse("#button2")),enableTempletControl()}function cancelTempletButton(){$("#button2").empty(),disableTempletControl()}function saveAndUpdateTemplet(){$.ajax({type:"post",dataType:"json",url:saveUri,data:{templetId:templetid,templetName:$("#templetName").val(),templetKey:templettype,templetContext:$("#printDivbody").val()},success:function(e){alertMsg(e),cancelTempletButton(),reload()},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}})}function enableTempletControl(){$("#printDivbody").removeAttr("disabled"),$("#templetName").removeAttr("disabled")}function disableTempletControl(){setTimeout("LockTempletControl();",200)}function LockTempletControl(){$("#printDivbody").attr("disabled","disabled"),$("#templetName").attr("disabled","disabled")}function loadTemplet(){var e=$("#templetKey").val();$("#templetName").val(""),$("#printDivbody").html("");var t=$("input[name='"+e+"']:checked").val();$("#templetName").val($("input[name='"+e+"']:checked + span").text()),$.ajax({type:"post",dataType:"html",url:getHtmlTempletUrl,data:{templetId:t},success:function(e){$("#printDivbody").html(e)},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}})}function reload(){var e=$("#templetKey").val();$.ajax({type:"post",dataType:"json",url:typeUri,data:{templetKey:e},success:function(t){$("#printDivtitle").html("");var n=t.rows;for(var r=0;r<n.length;r++){var i=n[r],s='<input type="radio" value="'+i.templetId+'" id="'+i.templetId+'" name="'+e+'" style="width:10px;"onclick="checkTemple($(this))"/>',o="<span id='span"+i.templetId+"'>"+i.templetName+"</span><br/>";$("#printDivtitle").append(s).append(o),i.templetChecked=="checked"&&$("#"+i.templetId).attr("checked","checked")}},error:function(e){e.readyState=="0"&&e.status=="0"&&alertMsg("对不起，无法连接服务器，请检查您的计算机硬件以及网络连接是否正常！","warning")}}),$("#addTempletBtn").click(function(){savaTempletData()}),$("#updateTempletBtn").click(function(){updataTempletData()}),$("#deleteTempletBtn").click(function(){deleteTempletData()}),disableTempletControl(),loadTemplet()}function printEsuyUIAllPagePreview(){try{LODOP=getLodop(document.getElementById("LODOP_OB"),document.getElementById("LODOP_EM")),LODOP.PRINT_INIT("打印控件Lodop功能演示_多页预览"),LODOP.SET_PRINT_STYLE("FontSize",18),LODOP.SET_PRINT_STYLE("Bold",1),printTempletHtml(),LODOP.PREVIEW()}catch(e){alert("打印失败！")}}function showTempletHtml(e){var t=e.lastIndexOf("</p>");e=e.substring(0,t),$("#showhtml").html(e);var n=htmlList();$("#printDiv").html(n[0])}function printTempletHtml(){var e=htmlList();for(var t=0;t<e.length;t++)LODOP.NewPage(),LODOP.ADD_PRINT_RECT(10,18,128,160,0,1),LODOP.ADD_PRINT_HTM(0,0,"100%","100%",e[t])}function htmlList(){var e=$("#showhtml").html(),t=e.split("</p>");return t}document.write("<object id='LODOP_OB' classid='clsid:2105C259-1E0C-4534-8141-A753534CB4CA' width='0' height='0'><embed id='LODOP_EM' type='application/x-print-lodop' width='0' height='0' pluginspage='install_lodop32.exe'></embed></object>");var LODOP,tableHtml,dataGridId,type,selectSubGroup,selectSubGroupName,selectSubGroupSort,selectSubGroupField,selectSubGroupFieldName,showDialog_,initChecked,toEdit=!1,customDialog,showEditDialog=function(e,t,n,r,i,s,o){this.dataGridId=e,this.type=t;var u=customDialog=$('<div style="overflow:hidden;"/>').dialog({href:projectPath+"common/base/print/selectCol.jsp",modal:!0,closable:!1,title:i,width:800,height:600,buttons:[{text:r,handler:function(){getSelectedField(n,o)}},{text:"取消",handler:function(){u.dialog("close")}}],onLoad:function(){loadPage(e,t,s),$("#dataGridId").val(e),$("#funType").val(s),$("#importFileDiv").hide(),$("#groupNameDiv").hide(),t==null?(s!=0&&(s==1?$("#importFileDiv").show():s==3),$("#addBtn").linkbutton("disable"),$("#updateBtn").linkbutton("disable"),$("#deleteBtn").linkbutton("disable"),$("#setBtn").linkbutton("disable"),toEdit=!0,enableControl()):s==2&&($("#groupNameDiv").show(),$("#addBtn").click(function(){savaData()}),$("#updateBtn").click(function(){updataData()}),$("#deleteBtn").click(function(){deleteData()}),$("#setBtn").click(function(){setDefaultGroup()}),disableControl())},onClose:function(){$(this).dialog("destroy")}})},typeUri=projectPath+"printDomDataAction!getTempletType.action",deleteUri=projectPath+"printDomDataAction!delectTemplet.action",saveUri=projectPath+"printDomDataAction!saveTemplet.action",getHtmlTempletUrl=projectPath+"printDomDataAction!getHtmlTemplet.action",templetid,templettype,showPrintDialog=function(e){var t=$('<div style="overflow:hidden;"/>').dialog({href:projectPath+"common/base/print/print.jsp",modal:!0,closable:!1,title:"套打管理",width:1e3,height:600,buttons:[{text:"取消",handler:function(){t.dialog("close")}}],onLoad:function(){showTempletHtml(e),$("#print_Butt").click(function(){printEsuyUIAllPagePreview()})},onClose:function(){$(this).dialog("destroy")}})};Array.prototype.in_array=function(e){for(i=0;i<this.length;i++)if(this[i]==e)return!0;return!1}